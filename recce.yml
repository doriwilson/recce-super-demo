# Preset Checks
# Please see https://docs.datarecce.io/features/preset-checks/
checks:
- name: Row count diff
  description: Check the row count diff for all table models.
  type: row_count_diff
  params:
    select: state:modified,config.materialized:table
- name: Schema diff
  description: Check the schema diff for all nodes.
  type: schema_diff
- name: Customer Orders UTC Date Validation
  description: Validates UTC date conversion in customer_orders. Automatically runs when customer_orders or its upstream dependencies change. Returns date columns - Recce compares base vs target and shows shifts. Validate that shifts are only 0 or ±1 day (JST→UTC: backward shifts of -1 day are expected).
  type: query
  params:
    sql_template: |
      -- Returns date columns for Recce to compare between base (prod) and target (dev)
      -- Recce will show the diff - check that date shifts are within expected bounds
      -- Expected for JST→UTC: dates shift backward by 0 or 1 day (UTC+9 → UTC)
      -- Example: 2018-01-02 JST → 2018-01-01 UTC (shift: -1 day)
      select
        customer_id,
        first_order_date,
        last_order_date,
        order_count
      from {{ ref('customer_orders') }}
      order by customer_id
    view_options:
      primary_keys:
        - customer_id
  # Validation: In Recce UI, check the diff shows date shifts of only 0 or ±1 day
  # For JST→UTC conversion: backward shifts (-1 day) are expected and normal
